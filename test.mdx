## Build the Action Tracker App Using Prompts (with Pica MCP)

This guide shows how to build the Action Tracker app using prompts only. We'll assume your Pica MCP is already configured. We'll focus on:

- **Instant DB**: schema and client setup
- **Minimal API route**: health check placeholder
- **Email sending route via Pica Gmail**: server action/route
- **UI for sending email**: email, name, waitingFor
- **Admin panel UI**: list, filter, and update statuses

Use the following prompts directly in your IDE assistant. Adjust names/paths if your project structure differs.

---

### Prerequisites

- A Next.js app (App Router) with TypeScript
- Pica MCP connected (we'll skip setup here)
- Environment variables prepared for your DB and Pica secret (we'll reference them in prompts)

---

## Zero-start: Create Next App (optional)

If you’re starting fresh, run:

```bash
npx create-next-app@latest action-tracker \
  --ts \
  --app \
  --eslint \
  --tailwind \
  --src-dir false \
  --import-alias "@/*"
cd action-tracker
```

Add required envs to `.env.local`:

```bash
INSTANT_DB_URL=your_db_url
INSTANT_DB_KEY=your_db_key
PICA_SECRET=your_pica_secrlib/db.ts (thin client)
```

```ts
√
```

### app/api/health/route.ts (bare minimum)

```ts
// app/api/health/route.ts
import { NextResponse } from "next/server";

export function GET() {
  return NextResponse.json({ ok: true, ts: Date.now() });
}
```

### app/api/send-email/route.ts (without Gmail send code)

````ts

## Build a Waitlist App with InstantDB + Pica (Prompt-Only Guide)

This section mirrors the app we just built: attractive waitlist form, InstantDB write, and Gmail send via Pica. Copy the prompts into your IDE assistant to generate files.

### 0) Create Next App

```bash
npx create-next-app@latest waitlist-app \
  --ts \
  --app \
  --eslint \
  --tailwind \
  --src-dir false \
  --import-alias "@/*"
cd waitlist-app
```

### 1) Environment Variables

Add a `.env.local` file with:

```bash
NEXT_PUBLIC_INSTANT_APP_ID=your_instant_app_id

PICA_SECRET_KEY=your_pica_secret_key
PICA_GMAIL_CONNECTION_KEY=your_gmail_connection_key
```

- Get your Pica API key at: [Pica API Keys](https://app.picaos.com/settings/api-keys)
- Connect Gmail at: [Pica Connections](https://app.picaos.com/connections)

### 2) Prompt: Create InstantDB client with schema

```text
Create a TypeScript file at path: lib/db.ts

Requirements:
- Use imports:
  import { init } from '@instantdb/react';
  import { i } from '@instantdb/core';
- Define a schema with one entity: signups
  - Fields:
    - name: string
    - email: string
    - interest: string (optional)
    - status: string // 'pending', 'confirmed', 'notified'
    - welcomeEmailSent: boolean
    - createdAt: date
- Initialize and export an InstantDB client with this schema using NEXT_PUBLIC_INSTANT_APP_ID
- Export the schema type

Exact file contents:
------------------------------------------------
import { init } from '@instantdb/react';
import { i } from '@instantdb/core';

// Define your schema
const schema = i.schema({
  entities: {
    signups: i.entity({
      name: i.string(),
      email: i.string(),
      interest: i.string().optional(),
      status: i.string(), // 'pending', 'confirmed', 'notified'
      welcomeEmailSent: i.boolean(),
      createdAt: i.date(),
    }),
  },
});

export const db = init({
  appId: process.env.NEXT_PUBLIC_INSTANT_APP_ID!,
  schema,
});

export type Schema = typeof schema;
------------------------------------------------

Notes:
- Keep exact indentation and spacing.
```

### 3) Prompt: Email route that uses Pica Gmail passthrough

```text
Create a TypeScript file at path: app/api/send-welcome-email/route.ts

Requirements:
- App Router API route (Next.js 13+):
  import { NextRequest, NextResponse } from 'next/server';
- Parse JSON body: { name: string; email: string; signupId: string }
- Construct an HTML email with a styled welcome message
- Build a MIME message with:
  From: your Gmail (placeholder: your-email@gmail.com)
  To, Subject, MIME-Version, Content-Type: text/html; charset=UTF-8
- Base64url-encode the MIME (Gmail requirement)
- Call Pica Gmail passthrough:
  POST https://api.picaos.com/v1/passthrough/users/me/messages
  Headers:
    - x-pica-secret: process.env.PICA_SECRET_KEY!
    - x-pica-connection-key: process.env.PICA_GMAIL_CONNECTION_KEY!
    - x-pica-action-id: 'conn_mod_def::F_JeJ3qaLEg::v9ICSQZxR0un5_ketxbCAQ'
    - Content-Type: 'application/json'
  Body: { raw: <base64url string>, labelIds: ['INBOX','UNREAD'] }
- On success: return { success: true, messageId, message }
- On error: return 500 with { success: false, error, details }

Use the exact contents we validated earlier.
```

### 4) Prompt: Attractive form UI (client page)

```text
Create `app/page.tsx` as a Client Component with an attractive form to collect:
- name (text), email (email), interest (select with options: early-access, pricing, features, updates)

Requirements:
- Tailwind-based glassy/gradient card style
- On submit:
  1) Create a `signups` row in InstantDB with fields { name, email, interest, status: 'pending', welcomeEmailSent: false, createdAt: new Date() }
  2) Call `POST /api/send-welcome-email` with { name, email, signupId }
  3) If success, update the row to { status: 'notified', welcomeEmailSent: true }
- Show loading, success, and error states
```

---

## Admin Panel (Prompt-Only Guide)

Build an admin panel to view and manage signups.

### 1) Prompt: Admin page and dashboard component

```text
Create `app/admin/page.tsx` and `components/AdminDashboard.tsx`.

AdminDashboard requirements:
- Controls: filter by status (all | pending | notified)
- Table: name, email, interest, status, createdAt
- Per-row action to set status to 'confirmed' or back to 'pending'
- Attractive Tailwind styling; optimistic update UX

Implementation hints:
- Fetch initial data via a server action or route that reads from InstantDB
- Use `db.transact([ db.tx.signups[id].update({ status: 'confirmed' }) ])` for updates
```

### 2) Prompt: Admin API endpoints

```text
Create two routes:
1) `app/api/signups/route.ts` (GET) → list signups; optional `?status=pending|notified|confirmed`
2) `app/api/signups/[id]/status/route.ts` (POST) → body { status: 'pending' | 'notified' | 'confirmed' }

Behavior:
- Validate inputs and return 400 on invalid
- Use InstantDB transact updates against `signups`
- Respond JSON { ok: true }
```

### 3) Prompt: Environment recap

```text
Ensure `.env.local` contains:
- NEXT_PUBLIC_INSTANT_APP_ID=
- PICA_SECRET_KEY=
- PICA_GMAIL_CONNECTION_KEY=

Get Pica API key: https://app.picaos.com/settings/api-keys
Connect Gmail: https://app.picaos.com/connections
```

Links: [Pica API Keys](https://app.picaos.com/settings/api-keys), [Pica Connections](https://app.picaos.com/connections)

---

## Prompts-Only: Build a Beautiful Waitlist App + Admin (No Code Snippets)

Use the following prompts in your IDE assistant to generate the entire app. Do not paste code from this blog; simply use the prompts in sequence. No MCP required.

### Prompt 1 — Initialize the Project

```text
Create a new Next.js (App Router, TypeScript, Tailwind, ESLint) project named "waitlist-pro". Add a modern base layout and global styles with a dark gradient background and clean typography. Ensure Tailwind is wired and a minimal landing page renders.
```

### Prompt 2 — Environment Variables

```text
Add a .env.local with:
- NEXT_PUBLIC_INSTANT_APP_ID=
- PICA_SECRET_KEY=
- PICA_GMAIL_CONNECTION_KEY=

Document where to obtain values and link in README:
- Pica API keys: https://app.picaos.com/settings/api-keys
- Pica Gmail connection: https://app.picaos.com/connections
Validate env loading in development.
```

### Prompt 3 — InstantDB Client and Schema

```text
Create an InstantDB client and schema in lib/db.ts using @instantdb/react and @instantdb/core. Define an entity `signups` with fields: name (string), email (string), interest (optional string), status (string: 'pending' | 'confirmed' | 'notified'), welcomeEmailSent (boolean), createdAt (date). Export the initialized client and the schema type. Ensure it compiles on both server and client as needed.
```

### Prompt 4 — Email API Route (Pica Gmail)

```text
Create an App Router API route at app/api/send-welcome-email/route.ts. Accept JSON body { name, email, signupId }. Generate a polished HTML welcome email (attractive header, friendly copy). Build an RFC 5322 MIME message with Content-Type text/html; encode as base64url; send via Pica Gmail passthrough (POST https://api.picaos.com/v1/passthrough/users/me/messages) with headers x-pica-secret, x-pica-connection-key, x-pica-action-id. Return JSON with success or error details.
```

### Prompt 5 — Attractive Waitlist Form UI

```text
Design a beautiful client-side form on app/page.tsx with fields: name, email, interest (select with values: early-access, pricing, features, updates). Use a glassy/gradient card look, accessible labels, and clear feedback. On submit: (1) create a `signups` record in InstantDB with status 'pending' and welcomeEmailSent false; (2) call /api/send-welcome-email; (3) on success, set status 'notified' and welcomeEmailSent true; (4) show success message and reset form. Include loading and error states.
```

### Prompt 6 — Basic Analytics and UX Polish

```text
Add a lightweight success indicator (toast or inline message) and a simple signup counter that reads from InstantDB. Ensure mobile responsiveness, keyboard accessibility, and focus management on error.
```

### Prompt 7 — Admin Panel (Pages & Data)

```text
Create an admin panel at app/admin/page.tsx with a modern dashboard layout. Add a data table listing signups with columns: name, email, interest, status, createdAt. Provide a filter for status (all | pending | notified | confirmed). Implement optimistic updates to set status to 'confirmed' or revert to 'pending' via InstantDB. Include empty-state and loading placeholders.
```

### Prompt 8 — Admin APIs

```text
Add admin API routes: (1) GET app/api/signups to list signups (support ?status=), (2) POST app/api/signups/[id]/status to update status. Validate input, return JSON, and handle errors gracefully. Ensure requests are server-only and do not leak secrets.
```

### Prompt 9 — Readme & Deploy Readiness

```text
Update README with setup steps, environment variables, links for Pica API keys and Gmail connection, and start commands. Add a short troubleshooting section for common Pica or InstantDB misconfigurations. Ensure build passes and routes compile for production.
```

### Prompt 10 — QA Scenarios

```text
Test plan: submit valid form, verify a signup row is created, email is sent, and status becomes 'notified'. Test invalid inputs and network errors show clear messaging. In admin, filter and update statuses; verify persistence after reload. Confirm env variables are required and missing ones surface a helpful error.
```
````

---

## 1) Prompt: Set up Instant DB schema and client

Use this prompt to create an Instant DB schema and a thin client in `lib/db.ts`.

```text
You are pair-programming with me. Implement a minimal Instant DB setup for a Next.js (App Router, TS) app:

GOALS
- Create a simple schema for an "actions" collection with fields: id (string, uuid), name (string), email (string), waitingFor (string), status ("pending" | "emailed" | "resolved"), createdAt (number, epoch ms)
- Add a light-weight DB client in `lib/db.ts` exposing CRUD helpers:
  - createAction({ name, email, waitingFor }) → creates doc with status "pending"
  - listActions({ status? }) → lists by optional status filter, newest first
  - markActionEmailed(id) → sets status to "emailed"
  - markActionResolved(id) → sets status to "resolved"
- Keep implementation simple and deterministic; prefer explicit typing. Use environment variables for DB URL/keys if needed, e.g. INSTANT_DB_URL, INSTANT_DB_KEY.
- Ensure the file can be imported from server code and React Server Components safely.

DELIVERABLES
- New file `instant.schema.ts` with schema definition
- Update/create `lib/db.ts` with typed helpers
- Add any minimal utility code required. Do not bring in heavy ORMs.

NOTES
- Use high-clarity TypeScript types, no `any`.
- Avoid runtime-heavy abstractions; write straightforward code.
```

---

## 2) Prompt: Add a bare-minimum health route

Create a minimal route at `app/api/health/route.ts` to validate SSR/runtime and serve as a template.

```text
Create `app/api/health/route.ts` with a minimal GET handler that returns JSON `{ ok: true, ts: Date.now() }`. Use Next.js App Router conventions, export `GET` with `NextResponse.json`. Keep it tiny and typed.
```

---

## 3) Prompt: Use Pica Gmail with MIME and base64url encoding (exact libs)

Use this prompt to wire the Gmail call in `app/api/send-email/route.ts`. Specify exact libraries to avoid errors.

````text
Edit `app/api/send-email/route.ts` to send email via Pica Gmail.

REQUIREMENTS
- Build a RFC 5322 MIME message using `mimetext` (npm package `mimetext`)
- Encode to base64url using `base64url` (npm package `base64url`), NOT Buffer.toString("base64") and manual replace
- Use Pica MCP Gmail action to send the raw message (base64url)
- Keep subject: "Welcome, ${name}!" and body text: "Thanks for signing up. We got your note about waiting for: ${waitingFor}. We'll be in touch."

STEPS
1) Install deps:
   - `npm i mimetext base64url`
2) Build MIME:
   ```ts
   import { MimeBuilder } from "mimetext";
   import base64url from "base64url";

   const message = new MimeBuilder("text/plain")
     .setSender("Your Name <me@example.com>")
     .setRecipient(`${name} <${email}>`)
     .setSubject(`Welcome, ${name}!`)
     .setMessage(`Thanks for signing up. We got your note about waiting for: ${waitingFor}. We'll be in touch.`)
     .asRaw();

   const raw = base64url(Buffer.from(message));
````

3. Call Pica Gmail send action with `{ raw }` and your connected Gmail account
4. On success, call `markActionEmailed(action.id)`
5. Return `{ ok: true, id: action.id }`

````

---

## 4) Prompts: Create UI (Cursor-only prompts, no code pasted here)

Use these prompts to have Cursor generate the UIs without copy-pasting code in this guide.

### Prompt: EmailSignup UI (attractive)

```text
Create `components/EmailSignup.tsx` as a Client Component with a modern, attractive form:
- Fields: name (text), email (email), waitingFor (textarea) — all required
- Styling: Tailwind, rounded cards, clear labels, accessible aria-live messages
- Submit POST to `/api/send-email`, disable while pending, optimistic reset on success
- Export default component and render it in `app/page.tsx`
````

### Prompt: AdminDashboard UI

```text
Create `components/AdminDashboard.tsx` as a Client Component:
- Controls: status filter (all | pending | emailed | resolved)
- Table: name, email, waitingFor, status, createdAt
- Actions: per-row buttons to mark emailed/resolved (disable appropriately)
- Fetch from `GET /api/actions?status=...`, update via `POST /api/actions/{id}/status`
- Attractive Tailwind styling; optimistic updates with fallback
- Create `app/admin/page.tsx` to render it
```

---

## 5) Prompt: Create API endpoints for Admin list/update

```text
Implement two endpoints:
1) `GET /api/actions?status=` → returns `ActionItem[]` using `listActions`
2) `POST /api/actions/{id}/status` body { status: "emailed" | "resolved" } → uses `markActionEmailed` or `markActionResolved`
- Validate status values; return 400 on invalid
- Keep responses JSON: { ok: true }
```

---

## 6) Prompt: Wire environment variables and config

Set up the environment variables needed and verify build/runtime.

```text
Add/readme notes for required env vars (do not commit secrets):
- INSTANT_DB_URL=
- INSTANT_DB_KEY=
- PICA_SECRET=

Validate that all server-side modules reading env are only imported server-side. Run dev build to ensure types are sound and routes compile.
```

---

## 7) Prompt: Lightweight QA

Use this to test happy-path flows.

```text
Test plan:
1. Load `/` and submit the email form with valid inputs → expect success toast
2. Confirm DB has a new action with status "emailed"
3. Load `/admin` → see the new row, filter by status
4. Change status to "resolved" → row updates; reload page to confirm persistence
5. Hit `/api/health` → `{ ok: true }` JSON
```

---

### What we skipped

- Pica MCP connection setup and secrets management. Add those per your environment.

### Next steps

- Add auth to `/admin`
- Add pagination and search
- Add HTML email template and analytics